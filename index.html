<!DOCTYPE html>
<html>
<head>
  <title>Image Selection</title>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script>
    const images = [
      { url: '/images/image_1.jpg', name: 'Image 1' },
      { url: '/images/image_2.jpg', name: 'Image 2' },
      { url: '/images/image_3.jpg', name: 'Image 3' },
	  { url: '/images/image_4.jpg', name: 'Image 4' },
	  { url: '/images/image_5.jpg', name: 'Image 5' },
	  { url: '/images/image_6.jpg', name: 'Image 6' },
	  { url: '/images/image_7.jpg', name: 'Image 7' },
	  { url: '/images/image_8.jpg', name: 'Image 8' },
	  { url: '/images/image_9.jpg', name: 'Image 9' },
	  { url: '/images/image_10.jpg', name: 'Image 10' },
	  { url: '/images/image_11.jpg', name: 'Image 11' },
      { url: '/images/image_12.jpg', name: 'Image 12' },
	  { url: '/images/image_13.jpg', name: 'Image 13' },
	  { url: '/images/image_14.jpg', name: 'Image 14' },
	  { url: '/images/image_15.jpg', name: 'Image 15' },
	  { url: '/images/image_16.jpg', name: 'Image 16' },
	  { url: '/images/image_17.jpg', name: 'Image 17' },
	  { url: '/images/image_18.jpg', name: 'Image 18' },
	  { url: '/images/image_19.jpg', name: 'Image 19' },
	  { url: '/images/image_20.jpg', name: 'Image 20' },
	  { url: '/images/image_21.jpg', name: 'Image 21' },
      { url: '/images/image_22.jpg', name: 'Image 22' },
	  { url: '/images/image_23.jpg', name: 'Image 23' },
	  { url: '/images/image_24.jpg', name: 'Image 24' },
	  { url: '/images/image_25.jpg', name: 'Image 25' },
	  { url: '/images/image_26.jpg', name: 'Image 26' },
	  { url: '/images/image_27.jpg', name: 'Image 27' },
	  { url: '/images/image_28.jpg', name: 'Image 28' },
	  { url: '/images/image_29.jpg', name: 'Image 29' },
	  { url: '/images/image_30.jpg', name: 'Image 30' },
	  { url: '/images/image_31.jpg', name: 'Image 31' },
      { url: '/images/image_32.jpg', name: 'Image 32' },
	  { url: '/images/image_33.jpg', name: 'Image 33' },
	  { url: '/images/image_34.jpg', name: 'Image 34' },
	  { url: '/images/image_35.jpg', name: 'Image 35' },
	  { url: '/images/image_36.jpg', name: 'Image 36' },
	  { url: '/images/image_37.jpg', name: 'Image 37' },
	  { url: '/images/image_38.jpg', name: 'Image 38' },
	  { url: '/images/image_39.jpg', name: 'Image 39' },
	  { url: '/images/image_40.jpg', name: 'Image 40' },
	  { url: '/images/image_41.jpg', name: 'Image 41' },
      { url: '/images/image_42.jpg', name: 'Image 42' },
	  { url: '/images/image_43.jpg', name: 'Image 43' },
	  { url: '/images/image_44.jpg', name: 'Image 44' },
	  { url: '/images/image_45.jpg', name: 'Image 45' },
	  { url: '/images/image_46.jpg', name: 'Image 46' },
	  { url: '/images/image_47.jpg', name: 'Image 47' },
	  { url: '/images/image_48.jpg', name: 'Image 48' },
	  { url: '/images/image_49.jpg', name: 'Image 49' },
	  { url: '/images/image_50.jpg', name: 'Image 50' },
    ]; // Add your image URLs here

    const results = [];

    function submitSelection() {
      const nameInput = document.getElementById('name-input');
      const name = nameInput.value.trim();
      if (name === '') {
        alert('Please enter your name.');
        return;
      }

      const selectedOptions = [];

      const imageContainers = document.getElementsByClassName('image-container');
      for (let i = 0; i < imageContainers.length; i++) {
        const imageContainer = imageContainers[i];
        const selectedOption = imageContainer.querySelector('.active');

        if (selectedOption) {
          const value = parseInt(selectedOption.dataset.value);
          selectedOptions.push(value);
        }
      }
	  console.log(selectedOptions.length==imageContainers.length)
	  console.log(imageContainers.length)
	  console.log(selectedOptions.length)
	  if (selectedOptions.length==imageContainers.length){
	  const payload = {
        name: name,
        selections: selectedOptions,
      }

      axios.post('/results', { data: payload })
        .then(() => {
          alert('Results submitted successfully.');
          results.length = 0; // Clear the results array
        })
        .catch((error) => {
          console.error('Failed to submit results:', error);
        });}
		else{
	  alert("Please select a label for all the images")
	  }

      
    }

    window.addEventListener('DOMContentLoaded', () => {
      const imageContainer = document.getElementById('image-container');

      let rowDiv;
      let imagesInRow = 0;

      images.forEach((image, index) => {
        if (imagesInRow === 0) {
          rowDiv = document.createElement('div');
          rowDiv.classList.add('image-row');
        }

        const imageElement = document.createElement('img');
        imageElement.src = image.url;
        imageElement.classList.add('image');

        const nameElement = document.createElement('p');
        nameElement.textContent = image.name;

        const label0Button = document.createElement('button');
        label0Button.textContent = 'Label 0';
        label0Button.dataset.value = '0';
        label0Button.classList.add('label-button');

        const label1Button = document.createElement('button');
        label1Button.textContent = 'Label 1';
        label1Button.dataset.value = '1';
        label1Button.classList.add('label-button');

        const imageContainerDiv = document.createElement('div');
        imageContainerDiv.classList.add('image-container');
        imageContainerDiv.appendChild(imageElement);
        imageContainerDiv.appendChild(nameElement);
        imageContainerDiv.appendChild(label0Button);
        imageContainerDiv.appendChild(label1Button);

        rowDiv.appendChild(imageContainerDiv);
        imagesInRow++;

        if (imagesInRow === 5) {
          imageContainer.appendChild(rowDiv);
          imagesInRow = 0;
        }
      });

      if (imagesInRow > 0) {
        imageContainer.appendChild(rowDiv);
      }

      const labelButtons = document.querySelectorAll('.label-button');
      labelButtons.forEach((button) => {
        button.addEventListener('click', () => {
          const activeButton = button.parentNode.querySelector('.active');
          if (activeButton) {
            activeButton.classList.remove('active');
          }
          button.classList.add('active');
        });
      });
    });
  </script>
  <style>
    .image-container {
      display: inline-block;
      margin: 10px;
      text-align: center;
    }

    .image-row {
      text-align: center;
    }

    img {
      width: 100%;
      height: 200px;
    }
    
    p {
      margin: 5px 0;
    }
    h1{
		text-align: center;
	}
    .label-button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      background-color: #e0e0e0;
      cursor: pointer;
    }
    
    .label-button.active {
      background-color: #a9a9a9;
    }
	#inputele{
		display:flex;
		justify-content:center;
	}
  </style>
</head>
<body>
  <h1>Image Selection</h1>
  <div id="inputele">
	<label for="name-input">Your Name:</label>
	  <input type="text" id="name-input" required>
	  </div>
	  <div id="image-container"></div>
	  <button onclick="submitSelection()">Submit</button>
</body>
</html>
